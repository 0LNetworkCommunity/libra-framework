name: tools-tests

on:
  push:
    tags:
      - '*'
    branches:
      - 'ci'
jobs:
  ######## WARM UP CACHES ########
  preheat: # Warm up the cache
    uses: ./.github/workflows/preheat.yaml

  ######## TYPES CHECK ########
  types:
    needs: preheat
    strategy:
      fail-fast: true
    runs-on: ubuntu-20.04
    steps:
      - name: set up common ubuntu test environment
        uses: 0o-de-lally/libra-v7/.github/actions/build_env@ci

      - name: types test
        working-directory: ./types
        run: cargo t
  # tools:
  #   name: libra-tools test
  #   needs: preheat
  #   strategy:
  #     fail-fast: false
  #   runs-on: ubuntu-20.04
  #   steps:
  #     - uses: ./.github/workflows/env.yaml

  #     # Check test suite meta tests
  #     - name: smoke-tests
  #       working-directory: ./smoke-tests
  #       run: cargo t --release

  #     # Tools tests
  #     - name: genesis
  #       working-directory: ./tools/genesis
  #       run: cargo t --release
  #     - name: query
  #       working-directory: ./tools/query
  #       run: cargo t --release
  #     - name: tower
  #       working-directory: ./tools/tower
  #       run: cargo t --release
  #     - name: txs
  #       working-directory: ./tools/txs
  #       run: cargo t --release
  #     - name: wallet
  #       working-directory: ./tools/wallet
  #       run: cargo t --release
